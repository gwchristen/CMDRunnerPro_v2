<Window x:Class="CmdRunnerPro.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:local="clr-namespace:CmdRunnerPro.Views"
        xmlns:utils="clr-namespace:CmdRunnerPro.Utilities"
        xmlns:conv="clr-namespace:CmdRunnerPro"
        Title="CMD Runner Pro"
        Width="1100" Height="700"
        Style="{StaticResource MaterialDesignWindow}">
    <Window.Resources>
        <conv:NullToBoolConverter x:Key="NullToBool"/>
        <conv:InverseBoolConverter x:Key="InverseBool"/>
    </Window.Resources>

    <materialDesign:DialogHost Identifier="RootDialog">
        <DockPanel>

            <!-- Top Bar -->
            <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="8">
                <ToggleButton Content="Dark Theme"
                              IsChecked="{Binding IsDarkTheme, Mode=TwoWay}"
                              Style="{DynamicResource MaterialDesignSwitchToggleButton}"
                              Margin="0,0,12,0"/>
                <TextBlock Text="Primary:" VerticalAlignment="Center" Margin="12,0,4,0"/>
                <ComboBox Width="120"
                          SelectedItem="{Binding PrimaryColor, Mode=TwoWay}"
                          ItemsSource="{Binding MdixPrimaryColors}" />
                <TextBlock Text="Secondary:" VerticalAlignment="Center" Margin="12,0,4,0"/>
                <ComboBox Width="120"
                          SelectedItem="{Binding SecondaryColor, Mode=TwoWay}"
                          ItemsSource="{Binding MdixSecondaryColors}" />
                <CheckBox Content="Timestamps"
                          IsChecked="{Binding Settings.ShowTimestamps, Mode=TwoWay}"
                          Margin="16,0,0,0" VerticalAlignment="Center"/>
            </StackPanel>

            <!-- Body -->
            <Grid Margin="8">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="360"/>
                    <ColumnDefinition Width="10"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Inputs + Presets -->
                <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="0,0,8,0">

                        <TextBlock Text="Inputs" FontWeight="SemiBold" Margin="0,0,0,4"/>
                        <StackPanel Orientation="Vertical" Margin="0,0,0,12">
                            <ComboBox Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                      materialDesign:HintAssist.Hint="COM1"
                                      ItemsSource="{Binding Ports}"
                                      SelectedItem="{Binding SelectedCom1}"
                                      DisplayMemberPath="Name"/>
                            <ComboBox Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                      materialDesign:HintAssist.Hint="COM2"
                                      ItemsSource="{Binding Ports}"
                                      SelectedItem="{Binding SelectedCom2}"
                                      DisplayMemberPath="Name" Margin="0,8,0,0"/>
                            <TextBox Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                     materialDesign:HintAssist.Hint="Username"
                                     Text="{Binding Username, UpdateSourceTrigger=PropertyChanged}" Margin="0,8,0,0"/>
                            <PasswordBox Style="{StaticResource MaterialDesignOutlinedPasswordBox}"
                                         materialDesign:HintAssist.Hint="Password"
                                         utils:PasswordBoxHelper.BindPassword="True"
                                         utils:PasswordBoxHelper.BoundPassword="{Binding Password, Mode=TwoWay}" Margin="0,8,0,0"/>
                            <TextBox Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                     materialDesign:HintAssist.Hint="Opco"
                                     Text="{Binding Opco}" Margin="0,8,0,0"/>
                            <TextBox Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                     materialDesign:HintAssist.Hint="Program"
                                     Text="{Binding Program}" Margin="0,8,0,0"/>
                            <DockPanel Margin="0,8,0,0">
                                <TextBox Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                         materialDesign:HintAssist.Hint="Working Directory"
                                         Text="{Binding WorkingDirectory}" />
                                <Button Content="Browse"
                                        Command="{Binding BrowseWorkingDirectoryCommand}"
                                        Style="{StaticResource MaterialDesignOutlinedButton}"
                                        Margin="8,0,0,0" />
                            </DockPanel>
                        </StackPanel>

                        <TextBlock Text="Template" FontWeight="SemiBold" Margin="0,8,0,4"/>
                        <ComboBox Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                  materialDesign:HintAssist.Hint="Select Template"
                                  ItemsSource="{Binding Templates}"
                                  SelectedItem="{Binding SelectedTemplate}"
                                  DisplayMemberPath="Name"/>
                        <Button Content="Edit Template"
                                Command="{Binding OpenTemplateEditorCommand}"
                                Style="{StaticResource MaterialDesignOutlinedButton}"
                                Margin="0,8,0,0"/>

                        <Separator Margin="0,12,0,12"/>

                        <TextBlock Text="Presets" FontWeight="SemiBold" Margin="0,0,0,4"/>
                        <ListBox x:Name="PresetsList"
                                 ItemsSource="{Binding Presets}"
                                 SelectedItem="{Binding SelectedPreset}"
                                 DisplayMemberPath="Name"
                                 Height="160"/>
                        <Button Content="Load Preset"
                                Command="{Binding LoadPresetCommand}"
                                CommandParameter="{Binding SelectedItem, ElementName=PresetsList}"
                                Style="{StaticResource MaterialDesignRaisedButton}"
                                Margin="0,8,0,0"/>
                    </StackPanel>
                </ScrollViewer>

                <Grid Grid.Column="2">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Text="Output"
                               FontWeight="SemiBold"
                               Margin="0,0,0,4"/>

                    <Border Grid.Row="1" BorderBrush="{DynamicResource MaterialDesignDivider}" BorderThickness="1"
                            Padding="4">
                        <ListBox ItemsSource="{Binding OutputLines}"
                                 FontFamily="Consolas"
                                 FontSize="12"/>
                    </Border>

                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,8,0,0">
                        <Button Content="Run"
                                Command="{Binding RunCommand}"
                                Style="{StaticResource MaterialDesignRaisedButton}"/>
                        <Button Content="Stop"
                                Command="{Binding StopCommand}"
                                Style="{StaticResource MaterialDesignOutlinedButton}"
                                Margin="8,0,0,0"/>
                    </StackPanel>
                </Grid>
            </Grid>
        </DockPanel>
    </materialDesign:DialogHost>
</Window>